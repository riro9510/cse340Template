 <%- include('../partials/header') %>

    <main class="container">
        <h1 class="title"><%= title %></h1>
        
        <%# Flash messages %>
        <% if (typeof messages !== 'undefined' && Object.keys(messages).length > 0) { %>
            <div class="flash-messages">
                <% Object.keys(messages).forEach(key => { %>
                    <div class="flash-message <%= key %>">
                        <%= messages[key] %>
                    </div>
                <% }) %>
            </div>
        <% } %>

        <%# Display validation errors %>
        <% if (typeof errors !== 'undefined' && errors.length > 0) { %>
            <div class="errors">
                <ul>
                    <% errors.forEach(error => { %>
                        <li><%= error.msg %></li>
                    <% }) %>
                </ul>
            </div>
        <% } %>

        <div class="update-account">
            <% if (accountData) { %>
                <%# Account Update Form %>
                <form class="account-form" action="/account/update" method="POST">
                    <h2>Account Update</h2>
                    
                    <input type="hidden" name="account_id" value="<%= accountData.account_id %>">
                    
                    <div class="form-group">
                        <label for="account_firstname" class="form-label">First Name</label>
                        <input 
                            type="text" 
                            id="account_firstname" 
                            name="account_firstname" 
                            class="form-input" 
                            required
                            value="<%= typeof account_firstname !== 'undefined' ? account_firstname : accountData.account_firstname %>">
                    </div>
                    
                    <div class="form-group">
                        <label for="account_lastname" class="form-label">Last Name</label>
                        <input 
                            type="text" 
                            id="account_lastname" 
                            name="account_lastname" 
                            class="form-input" 
                            required
                            value="<%= typeof account_lastname !== 'undefined' ? account_lastname : accountData.account_lastname %>">
                    </div>
                    
                    <div class="form-group">
                        <label for="account_email" class="form-label">Email Address</label>
                        <input 
                            type="email" 
                            id="account_email" 
                            name="account_email" 
                            class="form-input" 
                            required
                            value="<%= typeof account_email !== 'undefined' ? account_email : accountData.account_email %>">
                    </div>
                    
                    <button type="submit" class="btn-primary">Update Account</button>
                </form>

                <%# Change Password Form %>
                <form class="password-form" action="/account/update-password" method="POST">
                    <h2>Change Password</h2>
                    
                    <input type="hidden" name="account_id" value="<%= accountData.account_id %>">
                    
                    <div class="form-group">
                        <label for="account_password" class="form-label">New Password</label>
                        <input 
                            type="password" 
                            id="account_password" 
                            name="account_password" 
                            class="form-input" 
                            required
                            pattern="^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[^a-zA-Z0-9])(?!.*\s).{12,}$">
                        
                        <div class="password-requirements">
                            <small>Password must meet the following requirements:</small>
                            <ul class="requirements-list">
                                <li>At least 12 characters long</li>
                                <li>Contains at least 1 capital letter</li>
                                <li>Contains at least 1 number</li>
                                <li>Contains at least 1 special character</li>
                            </ul>
                        </div>
                    </div>
                    
                    <button type="submit" class="btn-primary">Change Password</button>
                </form>

            <% } else { %>
                <p>Please log in to update your account.</p>
            <% } %>
        </div>